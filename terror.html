<!DOCTYPE html>
<html lang="es">

<head>
  <link rel="stylesheet" href="./css/styles.css">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Terror - MoviesHN</title>

  <!-- SEO -->
  <meta name="description"
    content="Pel√≠culas de Terror - MoviesHN. Mira las mejores pel√≠culas de terror online gratis en espa√±ol latino." />
  <meta name="keywords"
    content="pel√≠culas terror, horror online, terror espa√±ol latino, miedo, ClipsDePeliculasHN" />
  <meta name="author" content="ClipsDePeliculasHN" />

  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />

  <!-- Open Graph -->
  <meta property="og:title" content="Terror - MoviesHN" />
  <meta property="og:description"
    content="Las mejores pel√≠culas de terror online en espa√±ol latino, calidad HD." />
  <meta property="og:image" content="https://tusitio.com/assets/preview.jpg" />
  <meta property="og:url" content="https://tusitio.com/terror.html" />
  <meta property="og:type" content="website" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css">
</head>

<body class="page-category">

  <canvas id="background-canvas"></canvas>

  <header class="site-header">

    <!-- Fila superior: logo + hamburguesa -->
    <div class="header-top">
      <div class="logo">
        <a href="index.html">MoviesHN</a>
      </div>

      <!-- Bot√≥n hamburguesa (solo visible en m√≥vil) -->
      <button class="menu-toggle" aria-label="Abrir men√∫">
        <span class="hamburger"></span>
        <span class="hamburger"></span>
        <span class="hamburger"></span>
      </button>
    </div>

    <!-- Buscador -->
    <form class="search-form">
      <input type="text" placeholder="Buscar pel√≠culas..." aria-label="Buscar pel√≠culas..." />
      <button type="submit">Buscar</button>
    </form>
    <!-- Men√∫ principal -->
    <nav class="site-nav">
      <!-- Bot√≥n cerrar (solo en m√≥vil / men√∫ abierto) -->
      <button class="menu-close" aria-label="Cerrar men√∫">‚úï</button>
      <ul>
        <li><a href="index.html"><i class="fas fa-home"></i> Inicio</a></li>
        <li><a href="index.html#recientes"><i class="fas fa-fire"></i> Recientes</a></li>
        <li><a href="index.html#mas-vistas"><i class="fas fa-eye"></i> M√°s vistas</a></li>
        <li><a href="index.html#accion"><i class="fas fa-fist-raised"></i> Acci√≥n</a></li>
        <li><a href="terror.html" class="active"><i class="fas fa-ghost"></i> Terror</a></li>
        <li><a href="index.html#suspenso"><i class="fas fa-user-secret"></i> Suspenso</a></li>
        <li><a href="all-series.html"><i class="fas fa-tv"></i> Series</a></li>
        <li><a href="mylist.html"><i class="fas fa-list"></i> Mi Lista</a></li>
      </ul>
    </nav>
  </header>

  <main class="main-content">
    
    <div class="layout">
      <!-- Sidebar izquierdo -->
      <aside class="left-sidebar">
        <h3><i class="fas fa-fire"></i> Recientes</h3>
        <div id="recent-movies-sidebar" class="featured-series">
          <!-- Contenido generado por JS -->
        </div>

        <h3><i class="fas fa-star"></i> Destacadas</h3>
        <div class="featured-movies">
          <div class="featured-item">
            <img src="https://image.tmdb.org/t/p/w500/fjgSlNGECNgVeMJaOdDAXmGh7ZM.jpg" alt="The Matrix">
            <p>The Matrix</p>
          </div>
          <div class="featured-item">
            <img src="https://www.themoviedb.org/t/p/w600_and_h900_bestv2/hGiNkRgXTkF4C6WplyPrglEKtd0.jpg" alt="The Godfather">
            <p>The Godfather</p>
          </div>
        </div>
      </aside>

      <!-- Contenido central -->
      <div class="center-content">
        <!-- Category Hero Section -->
        <section class="category-hero">
          <div class="category-hero-content">
            <h1 class="category-title">
              <i class="fas fa-ghost"></i>
              Terror
            </h1>
            <p class="category-description">
              Sum√©rgete en el mundo del miedo con nuestra colecci√≥n de pel√≠culas de terror. 
              Desde cl√°sicos del horror hasta los √∫ltimos estrenos que te mantendr√°n al borde del asiento.
            </p>
            <div class="category-stats">
              <span id="movies-count">Cargando...</span> pel√≠culas disponibles
            </div>
          </div>
        </section>

        <!-- Filter Options -->
        <section class="filter-section">
          <div class="filter-container">
            <h3><i class="fas fa-filter"></i> Filtros</h3>
            <div class="filter-options">
              <select id="year-filter">
                <option value="">Todos los a√±os</option>
                <option value="2024">2024</option>
                <option value="2023">2023</option>
                <option value="2022">2022</option>
                <option value="2021">2021</option>
                <option value="2020">2020</option>
                <option value="2019">2019</option>
                <option value="2018">2018</option>
                <option value="older">Anteriores a 2018</option>
              </select>
              
              <select id="sort-filter">
                <option value="title">Ordenar por t√≠tulo</option>
                <option value="year-desc">M√°s recientes</option>
                <option value="year-asc">M√°s antiguos</option>
              </select>
              
              <button id="clear-filters">
                <i class="fas fa-times"></i> Limpiar filtros
              </button>
            </div>
          </div>
        </section>

        <!-- Movies Grid -->
        <section class="category-movies">
          <div id="movies-grid" class="movie-grid">
            <!-- Movies will be loaded here -->
          </div>
          
          <div id="no-movies" class="no-results" style="display: none;">
            <i class="fas fa-ghost"></i>
            <h3>No se encontraron pel√≠culas</h3>
            <p>No hay pel√≠culas de terror que coincidan con los filtros seleccionados.</p>
            <button onclick="clearFilters()">Ver todas las pel√≠culas de terror</button>
          </div>
        </section>
      </div>

      <!-- Sidebar derecho -->
      <aside class="right-sidebar">
        <h3><i class="fas fa-list"></i> G√©neros</h3>
        <div class="featured-movies">
          <div class="featured-item">
            <a href="index.html#accion">ü•ä Acci√≥n</a>
          </div>
          <div class="featured-item">
            <a href="index.html#comedia">üòÇ Comedia</a>
          </div>
          <div class="featured-item">
            <a href="index.html#drama">üé≠ Drama</a>
          </div>
          <div class="featured-item">
            <a href="index.html#ciencia-ficcion">üöÄ Ciencia Ficci√≥n</a>
          </div>
        </div>

        <h3><i class="fas fa-info-circle"></i> Informaci√≥n</h3>
        <div class="featured-movies">
          <div class="featured-item">
            <p>MoviesHN es tu plataforma favorita para ver pel√≠culas online.</p>
          </div>
          <div class="featured-item">
            <p>Actualizamos nuestro cat√°logo semanalmente con los √∫ltimos estrenos.</p>
          </div>
        </div>
      </aside>
    </div>

  </main>

  <div id="contact-banner-placeholder"></div>

  <footer>
    <p>&copy; 2025 MoviesHN. Todos los derechos reservados.</p>
  </footer>

  <script src="./js/menu.js"></script>
  <script src="./js/background.js"></script>
  <script src="./js/section-icons.js"></script>
  
  <script>
    // Terror page specific JavaScript
    let allMovies = [];
    let terrorMovies = [];
    let filteredMovies = [];

    // Initialize page
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // Load movies data
        const response = await fetch('data/movies.json');
        allMovies = await response.json();
        
        // Filter terror movies
        terrorMovies = allMovies.filter(movie => {
          const genres = Array.isArray(movie.genre) ? movie.genre : [];
          return genres.includes("Terror");
        });
        
        filteredMovies = [...terrorMovies];
        
        // Update stats
        document.getElementById('movies-count').textContent = terrorMovies.length;
        
        // Render movies
        renderMovies();
        
        // Initialize filters
        initializeFilters();
        
        // Initialize search functionality
        initializeSearch();
        
        // Initialize My List functionality
        initMyList();
        
        // Populate sidebar with recent movies
        populateSidebar();
        
        console.log(`Terror page loaded with ${terrorMovies.length} movies`);
        
      } catch (error) {
        console.error('Error loading movies:', error);
        document.getElementById('movies-grid').innerHTML = `
          <div class="no-results">
            <p>Error al cargar las pel√≠culas. Por favor, intenta de nuevo.</p>
          </div>
        `;
      }
    });

    // Initialize search functionality
    function initializeSearch() {
      const searchForm = document.querySelector('.search-form');
      const searchInput = searchForm.querySelector('input');
      
      searchForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const searchTerm = searchInput.value.trim().toLowerCase();
        
        if (searchTerm) {
          // Filter movies by search term
          filteredMovies = terrorMovies.filter(movie => 
            movie.title.toLowerCase().includes(searchTerm) ||
            (movie.originalTitle && movie.originalTitle.toLowerCase().includes(searchTerm)) ||
            (movie.description && movie.description.toLowerCase().includes(searchTerm))
          );
          renderMovies();
        } else {
          // Reset to all terror movies
          filteredMovies = [...terrorMovies];
          renderMovies();
        }
      });
      
      // Real-time search as user types
      searchInput.addEventListener('input', (e) => {
        const searchTerm = e.target.value.trim().toLowerCase();
        
        if (searchTerm.length >= 2) {
          filteredMovies = terrorMovies.filter(movie => 
            movie.title.toLowerCase().includes(searchTerm) ||
            (movie.originalTitle && movie.originalTitle.toLowerCase().includes(searchTerm))
          );
          renderMovies();
        } else if (searchTerm.length === 0) {
          filteredMovies = [...terrorMovies];
          renderMovies();
        }
      });
    }

    // Initialize My List functionality
    function initMyList() {
      document.addEventListener('click', (e) => {
        if (e.target.classList.contains('add-to-list')) {
          const movieId = e.target.getAttribute('data-id');
          const stored = JSON.parse(localStorage.getItem('myList')) || [];
          
          if (stored.includes(movieId)) {
            // Remove from list
            const index = stored.indexOf(movieId);
            stored.splice(index, 1);
            e.target.textContent = 'Mi lista';
            e.target.classList.remove('added-to-list');
          } else {
            // Add to list
            stored.push(movieId);
            e.target.textContent = 'En mi lista';
            e.target.classList.add('added-to-list');
          }
          
          localStorage.setItem('myList', JSON.stringify(stored));
        }
      });
    }

    // Populate sidebar with recent movies
    function populateSidebar() {
      const sidebarContainer = document.getElementById('recent-movies-sidebar');
      if (!sidebarContainer) return;

      // Get recent movies (from 2020 onwards)
      const recentMovies = allMovies.filter(movie => {
        const year = parseInt(movie.year, 10) || 0;
        return year >= 2020;
      }).slice(0, 5); // Only show 5 recent movies

      sidebarContainer.innerHTML = '';

      recentMovies.forEach(movie => {
        const item = document.createElement('div');
        item.className = 'featured-item';
        
        const hasEmbed = movie.embed && movie.embed.trim() !== "";
        const linkHref = hasEmbed ? `movie.html?id=${movie.id}` : "#";
        
        item.innerHTML = `
          <a href="${linkHref}" ${!hasEmbed ? 'class="unavailable"' : ''}>
            <img src="${movie.cover}" alt="${movie.title}" loading="lazy">
            <p>${movie.title}</p>
            <span class="year">${movie.year}</span>
          </a>
        `;
        
        sidebarContainer.appendChild(item);
      });
    }

    // Render movies
    function renderMovies() {
      const grid = document.getElementById('movies-grid');
      const noMovies = document.getElementById('no-movies');
      
      if (filteredMovies.length === 0) {
        grid.style.display = 'none';
        noMovies.style.display = 'block';
        return;
      }
      
      grid.style.display = 'grid';
      noMovies.style.display = 'none';
      grid.innerHTML = '';
      
      filteredMovies.forEach(movie => {
        const card = createMovieCard(movie);
        grid.appendChild(card);
      });
    }

    // Create movie card
    function createMovieCard(movie) {
      const card = document.createElement("div");
      card.className = "movie-card";

      const hasEmbed = movie.embed && movie.embed.trim() !== "";
      const stored = JSON.parse(localStorage.getItem("myList")) || [];
      const alreadyInList = stored.includes(movie.id);

      const linkHref = hasEmbed ? `movie.html?id=${movie.id}` : "";

      card.innerHTML = `
        <a ${linkHref ? `href="${linkHref}"` : ""} class="movie ${!linkHref ? "unavailable" : ""}">
          <img src="${movie.cover}" alt="${movie.title}" loading="lazy">
          <div class="movie-info">
            <h3>${movie.title}</h3>
            <p>${movie.year}</p>
          </div>      
        </a>
        <button class="add-to-list ${alreadyInList ? 'added-to-list' : ''}" data-id="${movie.id}">
          ${alreadyInList ? "En mi lista" : "Mi lista"}
        </button>
      `;

      return card;
    }

    // Initialize filters
    function initializeFilters() {
      const yearFilter = document.getElementById('year-filter');
      const sortFilter = document.getElementById('sort-filter');
      const clearButton = document.getElementById('clear-filters');

      yearFilter.addEventListener('change', applyFilters);
      sortFilter.addEventListener('change', applyFilters);
      clearButton.addEventListener('click', clearFilters);
    }

    // Apply filters
    function applyFilters() {
      const yearFilter = document.getElementById('year-filter').value;
      const sortFilter = document.getElementById('sort-filter').value;

      filteredMovies = [...terrorMovies];

      // Apply year filter
      if (yearFilter) {
        if (yearFilter === 'older') {
          filteredMovies = filteredMovies.filter(movie => 
            parseInt(movie.year) < 2018
          );
        } else {
          filteredMovies = filteredMovies.filter(movie => 
            movie.year.toString() === yearFilter
          );
        }
      }

      // Apply sorting
      if (sortFilter === 'year-desc') {
        filteredMovies.sort((a, b) => parseInt(b.year) - parseInt(a.year));
      } else if (sortFilter === 'year-asc') {
        filteredMovies.sort((a, b) => parseInt(a.year) - parseInt(b.year));
      } else if (sortFilter === 'title') {
        filteredMovies.sort((a, b) => a.title.localeCompare(b.title));
      }

      renderMovies();
    }

    // Clear filters
    function clearFilters() {
      document.getElementById('year-filter').value = '';
      document.getElementById('sort-filter').value = 'title';
      filteredMovies = [...terrorMovies];
      renderMovies();
    }
  </script>

  <script src="./js/components.js"></script>
</body>

</html>